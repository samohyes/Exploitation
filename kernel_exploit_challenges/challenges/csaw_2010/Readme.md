CSAW CTF 2010 Kernel Exploitation Challenge
==========================================

The finals for NYU Polyâ€™s CSAW CTF was this past weekend in New York City.  I thought I would post the kernel exploitation challenge I developed for the final round.  Feel free to try your hand at solving it!

The Setup
========
Each team is given unprivileged remote shell access to a Linux VM.  There is a vulnerable kernel module (csaw.ko) loaded into memory:

```
csaw@csaw ~ $ lsmod
Module                  Size  Used by
csaw                    1111  0
```

The kernel module exposes a /proc/csaw interface with which the team can interact with and attempt to exploit the vulnerability contained in the kernel module.  Upon successful exploitation and privilege escalation, the team can retrieve the key/flag hidden in the root-readable /root/key.txt file.

The full source code of the csaw.ko kernel module is provided to the team so that they can discover and subsequently exploit the vulnerability.  The csaw.c can be downloaded [here](http://jon.oberheide.org/files/csaw.c)

```
[   51.402373] csaw: called csaw_read
[   52.403098] csaw: called csaw_write
[   52.403150] Kernel panic - not syncing: stack-protector: Kernel stack is corrupted in: bf000190
[   52.403153] 
[   52.403276] [<c010e59c>] (unwind_backtrace+0x0/0x144) from [<c0a0664c>] (dump_stack+0x20/0x24)
[   52.403355] [<c0a0664c>] (dump_stack+0x20/0x24) from [<c0a0705c>] (panic+0x9c/0x21c)
[   52.403438] [<c0a0705c>] (panic+0x9c/0x21c) from [<c0193204>] (print_tainted+0x0/0xb8)
[   52.403518] CPU0: stopping
[   52.403611] [<c010e59c>] (unwind_backtrace+0x0/0x144) from [<c0a0664c>] (dump_stack+0x20/0x24)
[   52.403756] [<c0a0664c>] (dump_stack+0x20/0x24) from [<c010d010>] (handle_IPI+0x198/0x1cc)
[   52.403840] [<c010d010>] (handle_IPI+0x198/0x1cc) from [<c0100590>] (gic_handle_irq+0xb0/0xf4)
[   52.403982] [<c0100590>] (gic_handle_irq+0xb0/0xf4) from [<c0107280>] (__irq_usr+0x40/0x60)
[   52.404117] Exception stack(0xe9d53fb0 to 0xe9d53ff8)
[   52.404191] 3fa0:                                     42627658 414f62d8 00000400 00000001
[   52.404323] 3fc0: 41765790 0000019e 41765e18 414f62d8 80000000 4152e4f0 414f62d8 41765800
[   52.404456] 3fe0: 08000000 711bdcb8 4152e3ac 4152e3a8 800f0010 ffffffff
[   53.404879] Rebooting in 5 seconds..
[   58.406513] Going down for restart now
[   58.407230] Calling SCM to disable SPMI PMIC arbiter
```


